# CZS 项目进展记录

## 2014年3月24日
1. 解决Linux下MySQL数据库中文乱码问题。
2. 针对系统事件发邮件进行可配置开关。

## 2014年3月25日
- 商家入驻功能上线。
- 台桌二维码生成：网页打开后发送图片链接地址到邮箱，支持打包附件下载。
- 台桌二维码批量生成，命名规则为 `ticket_senceid_name.jpg`。

## 2014年3月26日
- 来自微信服务器的消息需回复，否则会重发三次。
- 菜单事件通过回复处理，而非发送客服消息（因客服消息每日发送有限制）。
- 商户信息完善：添加联系电话。
- 将二维码链接发送到用户邮箱（批量生成时）。
- 对二维码进行生成功能分类，区分不同扫描触发事件场景。
- 记录access token，每次获取后写入配置，便于下次系统启动重复利用（因有回去次数限制）。
- 未入驻前需先进行入驻才能试用二维码生成，二维码试用数量限制为5个。
- 二维码配置界面需限制二维码个数。

## 2014年3月27日
- 批量打包生成二维码并发送。
- 食客扫描进入商家系统。
- 商家菜单登记（打折、优惠、积分）二维码购买页面：`buy.jsp`。
- 在二维码表中添加二维码的服务器URL。
- 商家二维码管理页面：列表查看、下载、释放、续约时间。
- 获取结账消费码，食客评论功能，二维码分类型（台桌-结账获取菜谱）。
- 提示光顾本店信息。
- 二维码扫描次数累加，判断是否达到限制。
- 返回消费时附带结账链接，用户表中记录消费码。
- 商家PC终端登录链接：发送链接到邮箱，告知登录动态码。
- 一个菜品可以对应多张图片。

## 2014年3月31日
- 修复bug：添加菜单时，未勾选的禁用项添加失败。
- 添加资源图片删除功能。
- 完善菜单修改页面和商家信息。
- 实现顾客一览功能。
- 结账流程优化：顾客结账请求、确认结账等环节。
- 点菜功能：筛选分类、口味、同桌点餐情况。
- 二维码管理、结账确认、退订确认、服务员和后厨管理。
- 顾客一览播放声音提示。
- 台桌视图、账目统计、菜品点击统计、服务统计。
- 二维码申请管理（数量有限），购买使用次数用尽后自动回收。
- 评价功能模块（商家与顾客）。
- 菜点评、菜收藏、商家收藏功能。
- 平台分享推广，商家店铺推广页面分享。
- 商家人员角色设置管理（店主、前台收纳、服务员、后厨）。
- 获取商家地理位置，菜谱排序功能。
- 打印消费单功能。
- 顾客一览点击姓名弹出详细信息。
- 商家可给顾客发送消息。

## 其他修复与优化
- 修复首次扫描进入时插入两条用户信息的问题，考虑让前台操作换桌，一次性切换所有人。
- 个人与集体结账可同时申请的bug修复。
- 扫描二维码时未采集到个人信息的bug修复。
- 菜单修改分类与口味新增加方式的bug修复。
- 考虑到用户手机流量有限，优化图片加载方式，缩放处理以减少流量消耗，加快页面加载时间。
- 二维码打印及状态管理（是否在使用中）。
- 顾客服务功能：我的收藏（收藏店铺、收藏美食）。
- 解决乱码问题：将form get提交中文改为全部使用post提交。
- 顾客一览布局问题修复。
- 二维码发送失败问题修复。
- 不要禁止扫描二维码。
- 二维码配置生成时添加个数限制。
- 商家可上传多个图片介绍，但需限制数量，方便顾客分享查看。
- 菜品图片修改描述功能完善。
- 上传菜品图片时进行多个大小版本处理，适应不同网络环境。
- 结账时，商家可为顾客退掉未上的菜。
- 顾客一览设定起始时间（如当天的开始营业时间）。
- 添加菜品时提供特色、新增、招牌、最热、实惠、精品等标签。
- 通过消费中顾客数量判断店铺的余桌量。
- 顾客结账后，商家发送链接，顾客可对所吃菜品进行评价，并对商家进行总体评价。
- 打印错误问题修复：消息重读。
- 一桌人数及餐具计价问题，点菜时备注微辣等要求。
- 商家原有网站链接及标签管理功能。
- 商家基本信息完善，直接修改而非弹出界面。
- 分配角色提示成功。
- 订单一览可查看一桌的点菜情况、上了多少、还剩几个。
- 订单状态显示优化。
- 订单接受时比对份数是否一致。
- 二维码购买使用模式：购买总的使用次数，然后分配给生成的台桌二维码使用。

---

以上是CZS项目的进展记录，欢迎大家提出建议与反馈！
